<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 900" font-family="Segoe UI, Arial, sans-serif">
  <defs>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#1e3a5f"/>
      <stop offset="100%" style="stop-color:#2d5a87"/>
    </linearGradient>
    <linearGradient id="serviceGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3498db"/>
      <stop offset="100%" style="stop-color:#2980b9"/>
    </linearGradient>
    <linearGradient id="kafkaGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#e74c3c"/>
      <stop offset="100%" style="stop-color:#c0392b"/>
    </linearGradient>
    <linearGradient id="dbGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#27ae60"/>
      <stop offset="100%" style="stop-color:#1e8449"/>
    </linearGradient>
    <linearGradient id="infraGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#9b59b6"/>
      <stop offset="100%" style="stop-color:#8e44ad"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="1200" height="900" fill="#0d1117"/>
  
  <!-- Title -->
  <text x="600" y="40" text-anchor="middle" fill="#ffffff" font-size="28" font-weight="bold">ğŸ¯ Planning Poker Platform - Microservices Architecture</text>
  <text x="600" y="65" text-anchor="middle" fill="#8b949e" font-size="14">Event-Driven Architecture with Kafka | Spring Boot 3.x | Keycloak OIDC</text>

  <!-- Clients Section -->
  <rect x="350" y="85" width="500" height="60" rx="10" fill="url(#headerGrad)" filter="url(#shadow)"/>
  <text x="600" y="115" text-anchor="middle" fill="#ffffff" font-size="16" font-weight="bold">ğŸ‘¥ CLIENTS</text>
  <text x="600" y="135" text-anchor="middle" fill="#a8d8ff" font-size="12">Web App (Angular) | Mobile App | Postman</text>

  <!-- Arrow from Clients to Gateway -->
  <path d="M600 145 L600 175" stroke="#58a6ff" stroke-width="2" marker-end="url(#arrowhead)"/>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#58a6ff"/>
    </marker>
  </defs>

  <!-- API Gateway -->
  <rect x="300" y="175" width="600" height="70" rx="10" fill="#f39c12" filter="url(#shadow)"/>
  <text x="600" y="205" text-anchor="middle" fill="#000000" font-size="16" font-weight="bold">ğŸšª API GATEWAY (Spring Cloud Gateway)</text>
  <text x="600" y="225" text-anchor="middle" fill="#333333" font-size="11">Port 8080 | JWT Validation | Rate Limiting | Request Routing</text>
  <text x="600" y="238" text-anchor="middle" fill="#333333" font-size="10">/api/v1/rooms/** â†’ Room Service | /api/v1/votes/** â†’ Vote Service | /api/v1/admin/audit/** â†’ Audit Service</text>

  <!-- Arrows from Gateway to Services -->
  <path d="M400 245 L200 290" stroke="#58a6ff" stroke-width="2" marker-end="url(#arrowhead)"/>
  <path d="M600 245 L600 290" stroke="#58a6ff" stroke-width="2" marker-end="url(#arrowhead)"/>
  <path d="M800 245 L1000 290" stroke="#58a6ff" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Room Service -->
  <rect x="50" y="290" width="300" height="180" rx="10" fill="url(#serviceGrad)" filter="url(#shadow)"/>
  <text x="200" y="315" text-anchor="middle" fill="#ffffff" font-size="14" font-weight="bold">ğŸ  ROOM SERVICE</text>
  <text x="200" y="332" text-anchor="middle" fill="#a8d8ff" font-size="11">Port 8081</text>
  <line x1="70" y1="342" x2="330" y2="342" stroke="#ffffff" stroke-opacity="0.3"/>
  <text x="70" y="360" fill="#e8f4fd" font-size="10">â€¢ Room CRUD Operations</text>
  <text x="70" y="375" fill="#e8f4fd" font-size="10">â€¢ Story Management (CRUD)</text>
  <text x="70" y="390" fill="#e8f4fd" font-size="10">â€¢ Participant Management</text>
  <text x="70" y="405" fill="#e8f4fd" font-size="10">â€¢ Email Invitations</text>
  <text x="70" y="420" fill="#e8f4fd" font-size="10">â€¢ Short Link Generation</text>
  <text x="70" y="435" fill="#e8f4fd" font-size="10">â€¢ Start Voting (triggers event)</text>
  <text x="70" y="455" fill="#ffd700" font-size="9">ğŸ“¤ Produces: room-events, story-events</text>
  <text x="70" y="468" fill="#90EE90" font-size="9">ğŸ“¥ Consumes: vote-events (story completion)</text>

  <!-- Vote Service -->
  <rect x="450" y="290" width="300" height="180" rx="10" fill="url(#serviceGrad)" filter="url(#shadow)"/>
  <text x="600" y="315" text-anchor="middle" fill="#ffffff" font-size="14" font-weight="bold">ğŸ—³ï¸ VOTE SERVICE</text>
  <text x="600" y="332" text-anchor="middle" fill="#a8d8ff" font-size="11">Port 8082</text>
  <line x1="470" y1="342" x2="730" y2="342" stroke="#ffffff" stroke-opacity="0.3"/>
  <text x="470" y="360" fill="#e8f4fd" font-size="10">â€¢ Cast Votes</text>
  <text x="470" y="375" fill="#e8f4fd" font-size="10">â€¢ Reveal Votes (WebSocket)</text>
  <text x="470" y="390" fill="#e8f4fd" font-size="10">â€¢ Finish Voting</text>
  <text x="470" y="405" fill="#e8f4fd" font-size="10">â€¢ Reset Votes</text>
  <text x="470" y="420" fill="#e8f4fd" font-size="10">â€¢ Calculate Average &amp; Consensus</text>
  <text x="470" y="435" fill="#e8f4fd" font-size="10">â€¢ WebSocket STOMP Broadcasts</text>
  <text x="470" y="455" fill="#ffd700" font-size="9">ğŸ“¤ Produces: vote-events</text>
  <text x="470" y="468" fill="#90EE90" font-size="9">ğŸ“¥ Consumes: story-events (voting started)</text>

  <!-- Audit Service -->
  <rect x="850" y="290" width="300" height="180" rx="10" fill="url(#serviceGrad)" filter="url(#shadow)"/>
  <text x="1000" y="315" text-anchor="middle" fill="#ffffff" font-size="14" font-weight="bold">ğŸ“‹ AUDIT SERVICE</text>
  <text x="1000" y="332" text-anchor="middle" fill="#a8d8ff" font-size="11">Port 8083</text>
  <line x1="870" y1="342" x2="1130" y2="342" stroke="#ffffff" stroke-opacity="0.3"/>
  <text x="870" y="360" fill="#e8f4fd" font-size="10">â€¢ Consume All Events</text>
  <text x="870" y="375" fill="#e8f4fd" font-size="10">â€¢ Store Audit Logs</text>
  <text x="870" y="390" fill="#e8f4fd" font-size="10">â€¢ Query by Entity/User</text>
  <text x="870" y="405" fill="#e8f4fd" font-size="10">â€¢ Search/Filter Logs</text>
  <text x="870" y="420" fill="#e8f4fd" font-size="10">â€¢ Admin-Only Access</text>
  <text x="870" y="435" fill="#e8f4fd" font-size="10">â€¢ Full Transparency Trail</text>
  <text x="870" y="455" fill="#90EE90" font-size="9">ğŸ“¥ Consumes: room-events, story-events,</text>
  <text x="870" y="468" fill="#90EE90" font-size="9">    vote-events</text>

  <!-- Kafka Event Bus -->
  <rect x="100" y="510" width="1000" height="70" rx="10" fill="url(#kafkaGrad)" filter="url(#shadow)"/>
  <text x="600" y="538" text-anchor="middle" fill="#ffffff" font-size="16" font-weight="bold">ğŸ“¨ APACHE KAFKA - Event Bus</text>
  <text x="600" y="558" text-anchor="middle" fill="#ffcccc" font-size="12">planning-poker.room-events | planning-poker.story-events | planning-poker.vote-events</text>
  <text x="600" y="573" text-anchor="middle" fill="#ffeeee" font-size="10">Async Communication | Event Sourcing | Loose Coupling | Guaranteed Delivery</text>

  <!-- Arrows to/from Kafka -->
  <path d="M200 470 L200 510" stroke="#f1c40f" stroke-width="2" marker-end="url(#arrowhead)"/>
  <path d="M600 470 L600 510" stroke="#f1c40f" stroke-width="2" marker-end="url(#arrowhead)"/>
  <path d="M1000 510 L1000 470" stroke="#2ecc71" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Bidirectional arrows for Room and Vote services -->
  <path d="M180 510 L180 470" stroke="#2ecc71" stroke-width="2" marker-end="url(#arrowhead)"/>
  <path d="M580 510 L580 470" stroke="#2ecc71" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Databases Row -->
  <text x="600" y="615" text-anchor="middle" fill="#8b949e" font-size="12">PERSISTENCE LAYER (Database per Service)</text>

  <!-- Room DB -->
  <rect x="80" y="630" width="200" height="60" rx="8" fill="url(#dbGrad)" filter="url(#shadow)"/>
  <text x="180" y="655" text-anchor="middle" fill="#ffffff" font-size="12" font-weight="bold">ğŸ—„ï¸ PostgreSQL</text>
  <text x="180" y="675" text-anchor="middle" fill="#d5f5e3" font-size="10">planning_poker_rooms</text>

  <!-- Vote DB -->
  <rect x="500" y="630" width="200" height="60" rx="8" fill="url(#dbGrad)" filter="url(#shadow)"/>
  <text x="600" y="655" text-anchor="middle" fill="#ffffff" font-size="12" font-weight="bold">ğŸ—„ï¸ PostgreSQL</text>
  <text x="600" y="675" text-anchor="middle" fill="#d5f5e3" font-size="10">planning_poker_votes</text>

  <!-- Audit DB -->
  <rect x="920" y="630" width="200" height="60" rx="8" fill="url(#dbGrad)" filter="url(#shadow)"/>
  <text x="1020" y="655" text-anchor="middle" fill="#ffffff" font-size="12" font-weight="bold">ğŸ—„ï¸ PostgreSQL</text>
  <text x="1020" y="675" text-anchor="middle" fill="#d5f5e3" font-size="10">planning_poker_audit</text>

  <!-- Arrows to DBs -->
  <path d="M200 470 L180 630" stroke="#27ae60" stroke-width="1.5" stroke-dasharray="5,3"/>
  <path d="M600 470 L600 630" stroke="#27ae60" stroke-width="1.5" stroke-dasharray="5,3"/>
  <path d="M1000 470 L1020 630" stroke="#27ae60" stroke-width="1.5" stroke-dasharray="5,3"/>

  <!-- Infrastructure Section -->
  <text x="600" y="720" text-anchor="middle" fill="#8b949e" font-size="12">INFRASTRUCTURE &amp; OBSERVABILITY</text>

  <!-- Keycloak -->
  <rect x="50" y="735" width="150" height="55" rx="8" fill="url(#infraGrad)" filter="url(#shadow)"/>
  <text x="125" y="760" text-anchor="middle" fill="#ffffff" font-size="11" font-weight="bold">ğŸ” Keycloak</text>
  <text x="125" y="778" text-anchor="middle" fill="#e8daef" font-size="9">OIDC | OAuth2</text>

  <!-- Redis -->
  <rect x="220" y="735" width="150" height="55" rx="8" fill="#e74c3c" filter="url(#shadow)"/>
  <text x="295" y="760" text-anchor="middle" fill="#ffffff" font-size="11" font-weight="bold">âš¡ Redis</text>
  <text x="295" y="778" text-anchor="middle" fill="#fadbd8" font-size="9">Caching</text>

  <!-- Prometheus -->
  <rect x="390" y="735" width="150" height="55" rx="8" fill="#e67e22" filter="url(#shadow)"/>
  <text x="465" y="760" text-anchor="middle" fill="#ffffff" font-size="11" font-weight="bold">ğŸ“Š Prometheus</text>
  <text x="465" y="778" text-anchor="middle" fill="#fdebd0" font-size="9">Metrics</text>

  <!-- Grafana -->
  <rect x="560" y="735" width="150" height="55" rx="8" fill="#f39c12" filter="url(#shadow)"/>
  <text x="635" y="760" text-anchor="middle" fill="#000000" font-size="11" font-weight="bold">ğŸ“ˆ Grafana</text>
  <text x="635" y="778" text-anchor="middle" fill="#333333" font-size="9">Dashboards</text>

  <!-- Jaeger -->
  <rect x="730" y="735" width="150" height="55" rx="8" fill="#1abc9c" filter="url(#shadow)"/>
  <text x="805" y="760" text-anchor="middle" fill="#ffffff" font-size="11" font-weight="bold">ğŸ” Jaeger</text>
  <text x="805" y="778" text-anchor="middle" fill="#d1f2eb" font-size="9">Tracing</text>

  <!-- Docker -->
  <rect x="900" y="735" width="150" height="55" rx="8" fill="#3498db" filter="url(#shadow)"/>
  <text x="975" y="760" text-anchor="middle" fill="#ffffff" font-size="11" font-weight="bold">ğŸ³ Docker</text>
  <text x="975" y="778" text-anchor="middle" fill="#d6eaf8" font-size="9">Containerization</text>

  <!-- WebSocket indicator -->
  <rect x="620" y="395" width="100" height="25" rx="5" fill="#9b59b6"/>
  <text x="670" y="412" text-anchor="middle" fill="#ffffff" font-size="9" font-weight="bold">ğŸ”Œ WebSocket</text>

  <!-- Legend -->
  <rect x="50" y="810" width="1100" height="75" rx="8" fill="#161b22" stroke="#30363d"/>
  <text x="600" y="830" text-anchor="middle" fill="#ffffff" font-size="12" font-weight="bold">LEGEND</text>
  
  <rect x="80" y="845" width="15" height="15" fill="#f1c40f"/>
  <text x="105" y="857" fill="#8b949e" font-size="10">Event Published</text>
  
  <rect x="220" y="845" width="15" height="15" fill="#2ecc71"/>
  <text x="245" y="857" fill="#8b949e" font-size="10">Event Consumed</text>
  
  <rect x="360" y="845" width="15" height="15" fill="#58a6ff"/>
  <text x="385" y="857" fill="#8b949e" font-size="10">HTTP Request</text>
  
  <line x1="500" y1="852" x2="550" y2="852" stroke="#27ae60" stroke-width="1.5" stroke-dasharray="5,3"/>
  <text x="560" y="857" fill="#8b949e" font-size="10">Database Connection</text>
  
  <text x="750" y="857" fill="#8b949e" font-size="10">ğŸ“¤ Producer | ğŸ“¥ Consumer | ğŸ”Œ WebSocket Real-time</text>

  <!-- Author -->
  <text x="1150" y="890" text-anchor="end" fill="#6e7681" font-size="10">Matilda Dervishaj | Lufthansa Planning Poker Platform</text>
</svg>

